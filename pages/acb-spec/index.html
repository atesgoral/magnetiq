<!DOCTYPE html PUBLIC
    "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Magnetiq - Adobe Color Book File Format Specification</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<link rel="shortcut icon" href="http://s.magnetiq.com/i/favicon.png"/>
<link rel="alternate" type="application/rss+xml" href="http://blog.magnetiq.com/rss"/>
<link rel="stylesheet" href="http://s.magnetiq.com/lib/syntaxhighlighter/styles/shCore.css"/>
<link rel="stylesheet" href="http://s.magnetiq.com/lib/syntaxhighlighter/styles/shThemeEclipse.css"/>
<link rel="stylesheet" href="http://s.magnetiq.com/style/layout.css" type="text/css"/>
<link rel="stylesheet" href="http://s.magnetiq.com/style/typography.css" type="text/css"/>
<link rel="stylesheet" href="http://s.magnetiq.com/style/colors.css" type="text/css"/>
<!--[if IE 6]>
<link rel="stylesheet" href="http://s.magnetiq.com/style/fix_ie6.css" type="text/css"/>
<![endif]-->

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script type="text/javascript" src="http://s.magnetiq.com/lib/syntaxhighlighter/scripts/shCore.js"></script>
<script type="text/javascript" src="http://s.magnetiq.com/lib/syntaxhighlighter/scripts/shBrushJScript.js"></script>
<script type="text/javascript" src="http://s.magnetiq.com/lib/syntaxhighlighter/scripts/shBrushXml.js"></script>
<script type="text/javascript" src="http://s.magnetiq.com/lib/syntaxhighlighter/scripts/shBrushJava.js"></script>
<script type="text/javascript" src="http://s.magnetiq.com/lib/cufon/cufon-yui.js"></script>
<script type="text/javascript" src="http://s.magnetiq.com/lib/cufon/Museo_700_600.font.js"></script>
<script type="text/javascript" src="http://s.magnetiq.com/js/enhance_page.js"></script>

</head>
<body>
<div id="header">
	<div class="fluid_700">
		<div class="one fluid column">
			<h1><a href="/">Magnetiq))</a></h1>
			<div id="description">by Ateş Göral</div>
		</div>
		<div class="clear"></div>
	</div>
</div>

<div id="nav" class="nav fluid_700">
	<ul class="three fluid column">
		<li><a href="/">Home</a></li>
		<li><a href="/#about">About</a></li>
		<li><a href="/#projects">Projects</a></li>
		<li><a href="/#experiments">Experiments</a></li>
		<li><a rel="me" href="http://blog.magnetiq.com/">Blog</a></li>
		<li><a href="http://blog.magnetiq.com/archive">Archive</a></li>
	</ul>
	<div class="clear"></div>
</div>

<div id="content" class="fluid_700">
	<div class="two fluid column post_text"><a href="#" rel="bookmark" title="Permanent Link"><h2>Adobe Color Book File Format Specification</h2></a>

<p><a href="http://www.adobe.com/products/photoshop/main.html">Adobe Photoshop</a>'s <em>Color Picker</em> has a <em>Custom Colors</em> dialog that offers a wide variety of colors from several industry-standard color catalogs such as ANPA, DIC, Focoltone and Pantone.</p>

<p class="center"><img src="http://magnetiq.com/wp-content/uploads/2008/06/custom_colors.jpg" width="400" height="279" alt="Custom Colors Dialog"/></p>
<p class="center"><small>Adobe Photoshop's Custom Colors Dialog</small></p>

<p>The color catalog data comes from <em>Adobe Color Book</em> files. These file have the <em>.ACB</em> file extension on Windows and reside inside the ".../Presets/Color Book" folder in a typical installation.</p>

<p>Partly out of curiosity and partly because I needed the color data for a job, I went through reverse-engineering the file format since an official file format specification wasn't readily available. I have put together what I've come up with into an unofficial file format specification.</p>

<p class="msg">
At the time of the writing of this specification, an official specification by Adobe wasn't publicly available (I don't know if it still isn't). I've put a lot of effort in creating this specification by reverse-engineering the existing color books (going through raw binary data, trial and error) and made it public domain for the benefit of everyone. <strong>If you've benefited from this specification</strong> in any way (professionally or not), would you perhaps consider <a href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=1036870">expressing your appreciation for this effort with a small donation</a>?
</p>

<h3>Data Types</h3>

<p>There are three main data types used throughout a color book file. 16-bit and 32-bit integers and strings.</p>

<p>Integers are in <a href="http://en.wikipedia.org/wiki/Endianness">big-endian</a> arrangement, so make sure you swap the bytes as necessary when reading/writing. I don't know whether they should be treated as signed or unsigned. Signed has worked for me.</p>

<p>Strings are like <a href="http://en.wikipedia.org/wiki/String_(computer_science)">Pascal strings</a>, starting with a 32-bit integer that gives the string length, followed by a sequence of <a href="http://en.wikipedia.org/wiki/Utf-16"><abbr title="Unicode Transformation Format">UTF</abbr>-16</a> characters (as kindly pointed out by <a href="http://spike.grobste.in/">Spike Grobstein</a>). Strings are not null-terminated therefore the string length gives the exact length of the string (without the length field). The UTF-16 characters are in big-endian order. Again, some byte swapping may be necessary.</p>

<table>
<tr><td>Length</td><td>UTF-16 characters</td></tr>
</table>

<h3>Header</h3>

<p>The file starts with a header that contains general information about the color book. The fields in the header are:</p>

<dl>
<dt id="acb_file_signature">Signature</dt>
<dd>4 consecutive characters that always read "8BCB". This probably stands for "8B Color Book".</dd>  
<dt id="acb_file_version">Book Version</dt>
<dd>This is a 16-bit integer denoting the file version. Photoshop 7.0 only opens files of version 1.</dd>
<dt id="acb_identifier">Book Identifier</dt>
<dd>A 16-bit integer. This is probably a unique identifier assigned by Adobe to each official color book. The most significant byte always seems to be 0x0b.</dd>
<dt id="acb_title">Book Title</dt>
<dd>A string. The title of the color book as it appears in Photoshop's color picker. A "^R" within the string stands for a registered trademark (&reg;) symbol.</dd>
<dt id="acb_prefix">Color Name Prefix</dt>
<dd>This string is prepended to the beginning of the name of each color in the book.</dd>
<dt id="acb_suffix">Color Name Suffix</dt>
<dd>This string is appended to the end of the name of each color in the book.</dd>
<dt id="acb_description">Book Description</dt>
<dd>This string usually contains copyright information. A "^C" stands for the copyright symbol (&copy;). "^R" is for the registered trademark symbol (&reg;). I don't know if there are any other special sequences.</dd>
<dt id="acb_color_count">Color Count</dt>
<dd>A 16-bit integer. This can be more than the colors visible within Photoshop. Some color records can be dummy records (see <a href="#acb_color_name">Color Name</a>) that are used as padding in order to control how colors get grouped in pages.</dd>
<dt id="acb_page_size">Page Size</dt>
<dd>A 16-bit integer that specifies the maximum number of colors that can appear on a page.</dd>
<dt id="acb_page_offset">Page Selector Offset</dt>
<dd>The page selector in Photoshop's color picker display a sample color from each page. This offset specifies which of the colors on a page will be used as the page sample. "0" means the first (topmost) color. "1" means the second one and so on. If the offset exceeds or is equal to the number of colors on the page, the last color is used.</dd>
<dt id="acb_color_space">Color Space/Library Identifier</dt>
<dd>
	<p>A 16-bit integer that specifies the color space/library. Values that Photoshop 7.0 recognizes are:<p>
	<table>
	<tr><th>Value</th><th>Meaning</th></tr>
	<tr><td>0</td><td>RGB</td></tr>
	<tr><td>2</td><td>CMYK</td></tr>
	<tr><td>7</td><td>Lab</td></tr>
	</table>
	<p>The rest of the values can be found in the official "Adobe Photoshop 6.0 File Formats Specification", but they apparently don't work for color books. Note that the 6.0 specification has no information on color book files. The full range of color space/library identifier values are:</p>
	<table>
	<tr><th>Value</th><th>Meaning</th></tr>
	<tr><td>0</td><td><a href="http://en.wikipedia.org/wiki/Rgb"><abbr title="Red, Green, Blue">RGB</abbr></a></td></tr>
	<tr><td>1</td><td><a href="http://en.wikipedia.org/wiki/HSV_color_space"><abbr title="Hue, Saturation, Brightness">HSB</abbr></a></td></tr>
	<tr><td>2</td><td><a href="http://en.wikipedia.org/wiki/CMYK"><abbr title="Cyan, Magenta, Yellow, Key (black)">CMYK</abbr></a></td></tr>
	<tr><td>3</td><td><a href="http://www.pantone.com/">Pantone</a></td></tr>
	<tr><td>4</td><td><a href="http://www.focoltone.com/">Focoltone</a></td></tr>
	<tr><td>5</td><td><a href="http://www.trumatch.com/">Trumatch</a></td></tr>
	<tr><td>6</td><td><a href="http://www.toyoink.com/">Toyo</a></td></tr>
	<tr><td>7</td><td><a href="http://en.wikipedia.org/wiki/Lab_color_space"><abbr title="Lightness, a chrominance, b chrominance">Lab</abbr></a> (CIELAB D50)</td></tr>
	<tr><td>8</td><td><a href="http://en.wikipedia.org/wiki/Grayscale">Grayscale</a></td></tr>
	<tr><td>10</td><td><a href="http://en.wikipedia.org/wiki/HKS_(colour_system)">HKS</a></td></tr>
	</table>
</dd>
</dl>

<h3>Color Records</h3>

<p>Immediately following the header are the individual color records. There are exactly as many color records as there was specified by the <a href="#acb_color_count">Color Count</a> field.</p>

<p>Photoshop may display fewer colors then there are in the color book file because some color records are dummy records used for padding purposes. When a page has to contain fewer colors than the number specified by <a href="#acb_page_size">Page Size</a>, dummy records are inserted. Photoshop doesn't display these records.</p>

<p>The structure of a single color record is as follows:</p>

<dl>   
<dt id="acb_color_name">Color Name</dt>
<dd>A string. Concatenating the <a href="#acb_prefix">Color Name Prefix</a>, the Color Name and the <a href="#acb_suffix">Color Name Suffix</a> gives us the full name of a color as it appears in Photoshop's color picker. If the length of this string is zero, the entire color record is for padding (see <a href="#acb_color_count">Color Count</a>.) The remaining fields of the color record are ignored.</dd>
<dt>Color Code</dt>
<dd>6 consecutive characters. This is probably a catalog code or short name. Sometimes they are padded with spaces on either side. Photoshop doesn't seem to be displaying this information to the user at all.</dd>
<dt>Color Components</dt>
<dd>
	<p>Depending on the color space, there can be 3 or 4 bytes, one byte for each color component:</p>
	<dl>
	<dt>RGB</dt>
	<dd>
		<table>
		<tr>
		<td>Red</td>
		<td>Green</td>
		<td>Blue</td>
		</tr>
		</table>
		<p>A byte for each of the Red, Green and Blue components. Each byte value directly translates to the corresponding level.</p>
		<pre class="brush:javascript">
r = r_byte; // 0 thru 255
g = g_byte; // 0 thru 255
b = b_byte; // 0 thru 255
		</pre>
	</dd>
	<dt>CMYK</dt>
	<dd>
		<table>
		<tr>
		<td>Cyan</td>
		<td>Magenta</td>
		<td>Yellow</td>
		<td>Black</td>
		</tr>
		</table>

		<p>A byte for each of the Cyan, Magenta, Yellow and Black components. Each is an unsigned value ranging from 0 to 255, representing 100 minus the intensity percentage, quantized to 255. To calculate the corresponding intensity percentage, subtract a byte value from 255, divide by 2.55 and then round to the nearest integer.</p>

		<pre class="brush:javascript">
c = (255 - c_byte) / 2.55 + 0.5; // 0% thru 100%
m = (255 - m_byte) / 2.55 + 0.5; // 0% thru 100%
y = (255 - y_byte) / 2.55 + 0.5; // 0% thru 100%
b = (255 - b_byte) / 2.55 + 0.5; // 0% thru 100%
		</pre>
	</dd>
	  
	<dt>Lab</dt>
	<dd>
		<table>
		<tr>
		<td>Lightness</td>
		<td>a chrominance</td>
		<td>b chrominance</td>
		</tr>
		</table>
		  
		<p>A byte for each of the Lightness, a chrominance and b chrominance components. The lightness percentage is quantized to 255. To get the lightness level percentage, divide the byte value by 2.55 and round to the nearest integer. The a and b chrominance values are offset by 128. To calculate their values, subtract 128 from the corresponding byte values.</p>

		<pre class="brush:javascript">
l = l_byte / 2.55 + 0.5; // 0% thru 100%
a = a_byte - 128; // -128 thru 127
b = b_byte - 128; // -128 thru 127
		</pre>
	</dd>
	</dl>
</dd>
</dl>

<h3>Spot/Process Identifier</h3>

<p>This field was probably added in Photoshop CS and beyond. 8 characters (bytes), "spflspot" for spot colors and "spflproc" for process colors. This just identifies the color book as a spot/process color book. (Thanks to Olivier for alerting me about the presence of these extra bytes in CS.)</p>

<h3>Illustrated Example</h3>

<p>Below is a portion from the beginning of "ANPA Color.acb" that ships with Adobe Photoshop 7.0 for Windows. Separate fields have been enclosed inside rectangles. A verbal walk-through will follow.</p>

<pre>
          +-----------+-----+-----+-----------+------------
00000000h:|38 42 43 42|00 01|0B B8|00 00 00 23|00 24 00 24 ; 8BCB.......#.$.$
          +-----------+-----+-----+-----------+------------
00000010h: 00 24 00 2F 00 63 00 6F 00 6C 00 6F 00 72 00 62 ; .$./.c.o.l.o.r.b
          -------------------------------------------------
00000020h: 00 6F 00 6F 00 6B 00 2F 00 41 00 4E 00 50 00 41 ; .o.o.k./.A.N.P.A
          -------------------------------------------------
00000030h: 00 2F 00 74 00 69 00 74 00 6C 00 65 00 3D 00 41 ; ./.t.i.t.l.e.=.A
          -------------------------------------------------
00000040h: 00 4E 00 50 00 41 00 20 00 43 00 6F 00 6C 00 6F ; .N.P.A. .C.o.l.o
          ------+-----------+------------------------------
00000050h: 00 72|00 00 00 1F|00 24 00 24 00 24 00 2F 00 63 ; .r.....$.$.$./.c
          ------+-----------+------------------------------
00000060h: 00 6F 00 6C 00 6F 00 72 00 62 00 6F 00 6F 00 6B ; .o.l.o.r.b.o.o.k
          -------------------------------------------------
00000070h: 00 2F 00 41 00 4E 00 50 00 41 00 2F 00 70 00 72 ; ./.A.N.P.A./.p.r
          -------------------------------------------------
00000080h: 00 65 00 66 00 69 00 78 00 3D 00 41 00 4E 00 50 ; .e.f.i.x.=.A.N.P
          ------------+-----------+------------------------
00000090h: 00 41 00 20|00 00 00 21|00 24 00 24 00 24 00 2F ; .A. ...!.$.$.$./
          ------------+-----------+------------------------
000000a0h: 00 63 00 6F 00 6C 00 6F 00 72 00 62 00 6F 00 6F ; .c.o.l.o.r.b.o.o
          -------------------------------------------------
000000b0h: 00 6B 00 2F 00 41 00 4E 00 50 00 41 00 2F 00 70 ; .k./.A.N.P.A./.p
          -------------------------------------------------
000000c0h: 00 6F 00 73 00 74 00 66 00 69 00 78 00 3D 00 20 ; .o.s.t.f.i.x.=. 
          ------------------------------+-----------+------
000000d0h: 00 41 00 64 00 50 00 72 00 6F|00 00 00 1F|00 24 ; .A.d.P.r.o.....$
          ------------------------------+-----------+------
000000e0h: 00 24 00 24 00 2F 00 63 00 6F 00 6C 00 6F 00 72 ; .$.$./.c.o.l.o.r
          -------------------------------------------------
000000f0h: 00 62 00 6F 00 6F 00 6B 00 2F 00 41 00 4E 00 50 ; .b.o.o.k./.A.N.P
          -------------------------------------------------
00000100h: 00 41 00 2F 00 64 00 65 00 73 00 63 00 72 00 69 ; .A./.d.e.s.c.r.i
          ------------------------------------+-----+-----+
00000110h: 00 70 00 74 00 69 00 6F 00 6E 00 3D|01 2C|00 06|; .p.t.i.o.n.=.,..
          +-----+-----+-----------+-----------+-----+-----+
00000120h:|00 05|00 07|00 00 00 04|00 37 00 31 00 2D 00 31|; .........7.1.-.1
          +-----+-----+-----+--+--+--+-----------+--------+
00000130h:|20 37 31 2D 31 44|F8|7B|7B|00 00 00 04|00 37 00 ;  71-1Dø{{.....7.
          +--------------+--+--+--+--+-----+--+--+--+------
00000140h: 31 00 2D 00 32|20 37 31 2D 32 44|F1|78|78|00 00 ; 1.-.2 71-2Dñxx..
          ------+--------+--------------+--+--+--+--+-----+          /\    /
00000150h: 00 04|00 37 00 31 00 2D 00 34|20 37 31 2D 34 44|;/\..7.1./  \71/  
          +--+--+--+-----------+--------+------------/\+--+/  \    /    \/
00000160h:|E3|72|7/\00 00 00 04|00 37 00 31 00 2D 00/  \20/    \../          
          +--+--+/  \----/\-+--+--+----/\----/\----/    \/      \/
00000170/\ 37 31/    \ 4/  \|68|67|00 /  \0 /  \0 /
 /\    /  \----/      \/    \--+-/\--/    \/    \/
/  \01/    \0 /              \1 /  \/ 
    \/      \/                \/ 
</pre>

<p>The file starts with the mandatory "8BCB" signature. Following that, the file version comes. The version must be 1 for Photoshop 7.0 to open the file. Then comes the unique color book identifier: 0x0bb8.</p>

<p>Next, the length of the title string is reported to be 0x23 (35) wide characters long. The title string is: "$$$/colorbook/ANPA/title=ANPA Color". The 31- character prefix string is: "$$$/colorbook/ANPA/prefix=ANPA ". Note the extra space character at the end. The suffix, "$$$/colorbook/ANPA/postfix= AdPro" is 33 characters long. This also has an extra space just after the equal sign. This file has no description, but the description string is there anyway. Having a length of 31 characters, it reads: "$$$/colorbook/ANPA/description=". I don't know what this path scheme is all about.</p>

<p>The following 0x012c gives us the number of colors in this book (300). There will be a maximum of 6 colors per page with a page offset of 5, which in turn means that the right-hand page selector in Photoshop's color picker will use the last color of each page. The color space is 7 (Lab).</p>

<p>The color records start here. The first color name is 4 characters long: "71-1". This should be concatenated with the prefix and suffix we saw earlier to produce the full color name: "ANPA 71-1 AdPro". The 6-character short name for this color is: " 71-1D". Notice the padding space at the left. The lightness component reads 0xf8 (248). This rounds down to a percentage of 248 / 255 * 100 = 97. The a and b chrominance values are both 0x7b (123). Subtracting 128 gives -5 for both components.</p>

<p>Immediately after this, the second color record starts. The name length is again 4, etc...</p>

<p class="msg">
If you're in need of a <strong>custom color book</strong> for your business, leave a comment to this post or <a href="mailto:ates@magnetiq.com">contact me directly</a>. I can create one for you very quickly.
</p>

<h3>See Also</h3>

<ul>
<li><a href="http://www.nomodes.com/aco.html">Adobe Photoshop Color File Format</a> by <a href="http://www.nomodes.com/">Larry Tesler</a></li>
<li><a href="http://www.duo-creative.com/chrisb/aco/">Reverse-Engineering of the Adobe Color File Format</a> by <a href="http://www.duo-creative.com/chrisb/">Chris Berry</a></li>
<li><a href="http://javastruct.googlecode.com/svn/trunk/javastruct/samples/photoshop/">AdobeColorBook Java class</a> by <a href="http://parduspardus.blogspot.com/">Mehmet D. Akin</a></li>
<li><a href="http://magnetiq.com/2007/05/08/acb2xml/">ACB2XML - Tool for exporting color book data as XML</a></li>
</ul></div>
	<div class="clear"></div>
</div>

<div id="footer">
	<div class="fluid_700">
		<div class="three fluid column">
			&copy; Ateş Göral -
			Licensed under a <a href="http://creativecommons.org/licenses/by-nc/2.0/">Creative Commons License</a> -
			Kick-ass hosting by <a href="http://www.webfaction.com/?affiliate=atesgoral">WebFaction</a>
			Powered by static HTML generated through <a href="http://www.python.org/">Python</a> -
			Using a fluid grid (<a id="toggle_grid" href="#">toggle</a>)
		</div>
		<div class="clear"></div>
	</div>
</div>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-912088-1");
pageTracker._setDomainName(".magnetiq.com");
pageTracker._trackPageview();
} catch(err) {}</script>
</body>
</html>
